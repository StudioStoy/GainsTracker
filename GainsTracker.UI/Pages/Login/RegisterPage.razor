@using GainsTracker.UI.Services.Auth.Interfaces
@using GainsTracker.UI.Elements.Button
@using GainsTracker.UI.Elements.Anchor
@using GainsTracker.UI.Elements.Group
@using GainsTracker.UI.Elements.Shared
@using GainsTracker.UI.Elements.Header
@using GainsTracker.UI.Elements.TextInput

@* Reserved for later use, for now the Auth0 redirect page is used. 01-01-2025 *@

<PageTitle>Register</PageTitle>

@inject IGainsAuthService AuthService;  
@inject NavigationManager NavigationManager

<div class="page-container">
    <img class="gains-logo" src="/images/logo.png" alt="Gainstracker Logo"/>
    <div class="register-container">
        <div class="anchor-container">
            <GtAnchor Variant="GtVariant.Primary" Href="/login">&lt; Already have an account?</GtAnchor>
        </div>
        <GtHeader>Create your account</GtHeader>
        <GtGroup @ref="_textInputGroup">
            <GtTextInput
                @bind-Value="_userHandle"
                Placeholder="Username"
                TextInputType="GtTextInputType.Text"
                Variant="GtVariant.Primary"
                Required="true"/>
            <GtTextInput
                @bind-Value="@_emailAddress"
                Placeholder="Email"
                TextInputType="GtTextInputType.Email"
                Variant="GtVariant.Primary"
                Required="true"/>
            <GtTextInput
                @bind-Value="@_password"
                Placeholder="Password"
                TextInputType="GtTextInputType.Password"
                Variant="GtVariant.Primary"
                Required="true"/>
        </GtGroup>
        <GtButton OnClick="Register" ShowMuscles="true">Start gaining!</GtButton>
    </div>
</div>

@code {
    private GtGroup? _textInputGroup;
    private string _userHandle = string.Empty;
    private string _emailAddress = string.Empty;
    private string _password = string.Empty;

    private async Task Register()
    {
        if (_textInputGroup != null && !_textInputGroup.ValidateAll()) return;

        var registered = await AuthService.Register(_userHandle, string.Empty, _emailAddress, _password);
        if (registered)
            NavigationManager.NavigateTo("/dashboard");
    }
}